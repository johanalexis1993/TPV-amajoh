(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const J="http://localhost:3000/api/v1/",u=(e,t)=>{console.error(e,t),alert(`${e}
${t?t.message:""}`)},W=()=>localStorage.getItem("token"),G=async e=>{const t=await e.json();if(!e.ok)throw new Error(t.message||"Error al realizar la operación.");return t},V=(e,t,o)=>{const a={"Cache-Control":o,Accept:"application/json"};if(e){const n=W();if(!n)throw new Error("No se encontró un token de autenticación.");a.Authorization=`Bearer ${n}`}return t instanceof FormData||(a["Content-Type"]="application/json"),a},K=async(e,t={},o=!0,a="max-age=120")=>{try{const n=await fetch(`${J}${e}`,{...t,headers:{...V(o,t.body,a),...t.headers}});return await G(n)}catch(n){throw u("Error en la petición",n),n}},x=async({method:e,url:t,id:o,data:a,form:n,requireAuth:r=!0})=>{const s=["POST","PUT"].includes(e)?a:void 0,c=["DELETE","PUT"].includes(e)?`${t}/${o}`:t;try{const l=await K(c,{method:e,body:s},r);return n&&e==="POST"&&n.reset(),l}catch(l){u(`Error en la petición ${e}`,l)}},Y=(e,t=!0)=>x({method:"GET",url:e,requireAuth:t}),Z=(e,t)=>x({method:"DELETE",url:e,id:t}),C=(e,t,o)=>x({method:"PUT",url:e,id:t,data:o}),y=(e,t,o,a=!0)=>x({method:"POST",url:e,data:t,form:o,requireAuth:a}),Q=(e,t,o,a,n,r)=>[{label:"Pedido ID:",value:e._id},{label:"Pedido:",value:t},{label:"Cliente:",value:o},{label:"Total:",value:e.total},{label:"Productos:",value:r},{label:"Hora de creación:",value:a},{label:"Tiempo transcurrido:",value:`${n} minutos`},{label:"Estado:",value:e.status}],X=(e,t)=>{e.forEach(o=>{const a=document.createElement("p");a.textContent=`${o.label} ${o.value}`,t.append(a)})},v=new Audio("/assets/Orders.mp3");let M=!1,q=!1;const L=e=>q=e,N=e=>M=e,U=(e,t)=>{t?e.classList.add("blinking"):e.classList.remove("blinking")},ee=()=>{const e=document.querySelectorAll('button[data-status="Pendiente"]');e.length>0&&M?(q||(v.loop=!0,v.play(),L(!0)),e.forEach(t=>{const o=t.closest("details").querySelector("summary");U(o,!0)})):q&&(v.pause(),v.currentTime=0,L(!1))};let k;const _=()=>{clearTimeout(k),k=setTimeout(()=>{ee()},100)};document.addEventListener("click",()=>N(!0));document.addEventListener("keydown",()=>N(!0));const te=e=>{const t=document.querySelector("#pedidos ol");t.innerHTML="";const o=document.createDocumentFragment(),a=c=>{const l=document.createElement("li");return l.textContent=c,l},n=document.createElement("h4");n.textContent=`Nombre de la comanda: ${e.nameTable}`,o.append(n);const r=document.createElement("ul");e.products.forEach(c=>r.append(a(`${c.title} - Precio: $${c.price}`))),o.append(r,a(`Total: $${e.total}`),a(`Usuario: ${e.user}`));const s=document.createElement("button");s.textContent="Enviar",s.addEventListener("click",()=>xe(e,t)),o.append(s),t.append(o)},oe=e=>{localStorage.removeItem("order");let t=JSON.parse(localStorage.getItem("order"))||{nameTable:"",user:localStorage.getItem("userId"),products:[],total:0};if(t.products.length===0){const o=prompt("Por favor, ingresa el nombre de la comanda:");if(o===null)return console.log("Operación cancelada por el usuario.");t.nameTable=o;const a=document.querySelector("#pedidos"),n=document.createElement("ol");a.append(n)}if(!t.user){const o=localStorage.getItem("userId");if(!o)return console.error("El id del usuario no está presente en el localStorage");t.user=o}t.products.push({id:e._id,title:e.title,price:e.price}),t.total+=e.price,localStorage.setItem("order",JSON.stringify(t)),te(t)},ae=async(e,t,o)=>{if(!confirm("¿Estás seguro de que lo quieres eliminar?"))return{ok:!1};try{const n=await Z(t,e);return o==="#tablaMerma"&&$(n,"tablaInventario","DELETE"),{ok:!0}}catch(n){return u("Error al eliminar",n),{ok:!1}}},Ce=(e,t,o,a)=>{if(a.ok){const r=document.querySelector(t).querySelectorAll("tbody tr");for(const s of r)if(s.querySelectorAll("td")[o.id].getAttribute("data-id")===e){s.remove();break}}else return},ne=(e,t,o)=>{if(o.ok){const a=document.querySelector(`li[data-id="${e}"]`);if(a){const n=a.parentElement;if(a.remove(),!n.querySelector("li")){const r=n.previousElementSibling;r&&r.tagName==="H2"&&r.textContent===t&&r.remove(),n.remove()}}}else return},D={lupins:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115674/altramuces_rsje17.webp",celery:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115674/apio_oerihw.webp",sulphurDioxideAndSulphites:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115674/azufreYsulfitos_yarnv3.webp",peanuts:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115674/cacahuetes_adclca.webp",crustaceans:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115675/crustaceos_hhe0a3.webp",treeNuts:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115675/frutosDeCascara_dn7dvs.webp",gluten:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115675/gluten_zjirt6.webp",eggs:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115675/huevos_oitpyp.webp",dairy:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115401/lacteos_qxvjzb.webp",molluscs:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115675/moluscos_x4o689.webp",mustard:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115689/mostaza_kv9zcp.webp",fish:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115689/pescado_poqsbd.webp",sesame:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115689/sesamo_ssfejb.webp",soy:"https://res.cloudinary.com/dx0fsy5fw/image/upload/f_webp,q_auto:eco/v1753115689/soja_e2ewfu.webp"},re=e=>{const t=document.createElement("ul");return t.classList.add("tooltip"),e.forEach(o=>{const a=document.createElement("li");if(a.textContent=o.name,o.imgAllergies&&o.imgAllergies.length>0){const n=document.createElement("figure");n.classList.add("allergen-images"),n.style.padding="0",o.imgAllergies.forEach(r=>{if(D[r]){const s=document.createElement("img");s.src=D[r],s.alt=r,s.title=r,s.style.width="var(--1-5rem)",s.style.height="var(--1-5rem)",n.append(s)}}),a.append(n)}t.append(a)}),t},R=e=>{const t=document.createElement("li"),o=document.createElement("figure"),a=document.createElement("picture"),n=document.createElement("img"),r=document.createElement("figcaption"),s=document.createElement("p"),c=document.createElement("h3"),l=document.createElement("button");t.dataset.id=e._id,n.src=e.imgUrl,n.alt=e.title,n.title=e.title,n.loading="eager";const i=re(e.ingredients);if(t.append(i),t.classList.add("has-tooltip"),s.textContent=`Precio: ${e.price.toFixed(2)}€`,c.textContent=e.title,l.textContent="Eliminar",l.classList.add("eliminar-btn"),l.addEventListener("click",async()=>{const d=await ae(e._id,"plate/");ne(e._id,e.category,d)}),a.append(n),o.append(a,r),r.append(s,c,l),t.append(o),e.stock==="available"){const d=document.createElement("button");d.textContent="Agregar",d.classList.add("agregar-btn"),d.addEventListener("click",()=>oe(e)),r.append(d)}return t},A=(e,t)=>{let o=Array.from(e.querySelectorAll("h2")).find(n=>n.textContent===t),a;return o?a=o.nextElementSibling:(o=document.createElement("h2"),o.textContent=t,a=document.createElement("ul"),e.append(o,a)),a},Ie=(e,t)=>{const o=document.querySelector(`#${t}`);o.innerHTML="";const a=document.createDocumentFragment();Object.entries(e).forEach(([n,r])=>{const s=A(a,n);r.forEach(c=>{const l=R(c);s.append(l)})}),o.append(a)},se=(e,t,o)=>{for(const[a,n]of t.entries()){const r=e.editables.find(s=>s.nombre===a);if(r)if(r.nombre==="reservationDate"){const c=new Date(n).toLocaleDateString("es-ES").replace(/\//g,"-");o[r.indice].innerText=c}else r.nombre==="precio"?o[r.indice].innerText=`${n}€`:o[r.indice].innerText=n}},j=(e,t,o=[],a)=>{const n=e.parentElement.querySelectorAll("p"),r=Array.from(n).find(s=>s.textContent.includes(`${a}:`));if(a==="Estado"){r.textContent=`Estado: ${t.status}`,e.textContent=t.status==="Preparando"?"Listo":t.status==="Listo"?"Cobrar":"Cobrada",t.status==="Cobrada"&&(e.disabled=!0),e.dataset.status=t.status;const s=e.closest("details").querySelector("summary");U(s,t.status==="Pendiente")}else if(a==="Productos"){const s=r.textContent.replace("Productos: ","").split(", ").filter(l=>l!==""),c=[...new Set([...s,...o])];r.textContent=`Productos: ${c.join(", ")}`}},ce=(e,t,o)=>{const a=document.querySelector(`li[data-id="${e}"]`);if(!a)return;const n=t==="available"?"unavailables":"platos-lista",r=document.querySelector(`#${n}`),s=A(r,o);s&&s.removeChild(a),s.children.length===0&&(r.removeChild(s.previousElementSibling),r.removeChild(s));const c=t==="available"?"platos-lista":"unavailables",l=document.querySelector(`#${c}`);A(l,o).append(a)},le=e=>{const t=document.querySelector(`button[data-order-id="${e}"]`);if(!t)return;const o=t.closest("li");if(!o)return;const a=t.getAttribute("data-status"),n=a==="Listo"?"Cobrada":a,r=n==="Cobrada"?"orderPaid":"pedidos";t.setAttribute("data-status",n);const s=document.querySelector(`#${r}`);if(!s)return;let c=s.querySelector("ul");c||(c=document.createElement("ul"),s.append(c)),c.append(o)},ie=(e,t)=>{if(e._id!==t)return console.error(`Product ID mismatch: expected '${t}', got '${e._id}'`);const o=.4,a=e.maxAmount;if(e.cantidad>a*o){const r=document.querySelector(`details[data-id="${t}"]`);r&&r.remove()}},Pe=async(e,t,o,a)=>{try{const n=new FormData,s=document.querySelector(`#${o}`).querySelectorAll("tbody tr");let c=null;for(const l of s){const i=l.querySelectorAll("td");if(i[a.id].getAttribute("data-id")===t){c=i;for(const p of a.editables){let m=i[p.indice].innerText;const T=m.replace(/[^\d.]/g,"");if(m=prompt(`Ingrese el nuevo ${p.nombre}:`,p.nombre==="precio"?T:m),p.nombre==="reservationDate"){const[h,w,f]=m.split("-");m=`${f}-${w.padStart(2,"0")}-${h.padStart(2,"0")}`}n.append(p.nombre,m)}const d=await C(e,t,n);return o==="tablaMerma"&&$(d,"tablaInventario","PUT"),se(a,n,c),o==="#tablaInventario"&&ie(d,t),d}}}catch(n){u("Error al editar elemento",n)}},de=async(e,t)=>{try{const o=JSON.parse(localStorage.getItem("platosSeleccionados"))||{products:[]},a=new FormData,n=o.products.map(s=>s.title);o.products.forEach((s,c)=>a.append(`products[${c}]`,s.id));const r=await C("pedidos",e,a);j(t,r,n,"Productos")}catch(o){u("Error al actualizar pedido",o)}},O=async(e,t,o,a=null)=>{try{let n=t==="Pendiente"?"Preparando":t==="Preparando"?"Listo":"Cobrada";const r=new FormData;r.append("status",n),n==="Cobrada"&&a&&r.append("paymentMethod",a);const s=await C("pedidos",e,r);j(o,s,[],"Estado"),requestAnimationFrame(()=>_())}catch(n){u("Error al actualizar el estado del pedido",n)}},qe=async()=>{try{const t=JSON.parse(localStorage.getItem("platosSeleccionados")).products;for(const o of t){const a=o.id,n=await Y(`plate/${a}`),r=n.stock,s=n.category,c=r==="available"?"unavailable":"available",l=new FormData;l.append("stock",c),await C("plate",a,l),ce(a,c,s)}}catch(e){u("Error al cambiar el estado del stock",e)}},B=e=>{const t=document.querySelectorAll(".agregar-btn"),o=document.querySelectorAll(".eliminar-btn"),a=e?"none":"inline-block";t.forEach(n=>n.style.display=a),o.forEach(n=>n.style.display=a)},ue=e=>{document.querySelectorAll(e).forEach(t=>{if(!t.querySelector(".plato-checkbox")){const o=document.createElement("input");o.type="checkbox",o.classList.add("plato-checkbox"),o.dataset.id=t.getAttribute("data-id"),o.dataset.title=t.querySelector("h3").textContent,t.insertBefore(o,t.firstChild)}})},me=()=>{let e=localStorage.getItem("platosSeleccionados");e||(e=JSON.stringify({products:[]}),localStorage.setItem("platosSeleccionados",e)),JSON.parse(e).products.forEach(o=>{const a=document.querySelector(`input[data-id="${o.id}"]`);a&&(a.checked=!0)})},z=e=>{if(e.target.classList.contains("plato-checkbox")){const t=e.target.dataset.id,o=e.target.dataset.title;let a=JSON.parse(localStorage.getItem("platosSeleccionados"))||{products:[]};const n=a.products.findIndex(r=>r.id===t);e.target.checked?n===-1&&a.products.push({id:t,title:o}):n!==-1&&a.products.splice(n,1),localStorage.setItem("platosSeleccionados",JSON.stringify(a))}},pe=(e,t)=>{localStorage.removeItem("platosSeleccionados"),document.querySelectorAll(".plato-checkbox").forEach(a=>a.remove()),e.textContent=t,document.removeEventListener("change",z)},fe=(e,t)=>{B(!0);const o=document.querySelector(e);if(o){const a=o.textContent;o.textContent="Enviar",ue(t),me();const n=()=>pe(o,a);o.addEventListener("click",n,{once:!0}),document.addEventListener("change",z)}},F=(e,t)=>{const a=e.total,n=a*.07,r=a-n,s=e.user[0]||e.user,c=s.rol&&s.rol!=="Admin",l="https://res.cloudinary.com/dx0fsy5fw/image/upload/f_auto,q_auto:eco/v1723802226/sello_bfeijb.png",i=window.open("","_blank");if(!i)return alert("No se pudo abrir la ventana de impresión");const d=`
    <html>
      <head>
        <meta charset="UTF-8" />
        <title>Recibo</title>
        <style>
          body {
            font-family: Arial, sans-serif;
            padding: 40px 30px;
            max-width: 600px;
            margin: auto;
            background: white;
          }
          h1, h2 { text-align: center; }
          p { margin: 4px 0; }
          footer {
            text-align: center;
            margin-top: 30px;
          }
          img.sello {
            width: 240px;
            position: absolute;
            bottom: 600px;
            right: 50px;
            opacity: 0.4;
            transform: rotate(-15deg);
          }
        </style>
      </head>
      <body>
        <h1>AMAJOH</h1>
        <p>CIF: J09702291</p>
        <p>Teléfono: 928981113</p>
        <p>Dirección: Calle El Cosco, Número 2</p>
        <hr />
        <h2>Recibo</h2>
        <p><strong>Pedido ID:</strong> ${e._id}</p>
        <p><strong>Cliente:</strong> ${s.name}</p>
        ${c?`<p><strong>CIF:</strong> ${s.cifOrAutonomo}</p>
               <p><strong>Teléfono:</strong> ${s.telephon}</p>
               <p><strong>Dirección:</strong> ${s.address}</p>`:""}
        <p><strong>Fecha:</strong> ${new Date(e.createdAt).toLocaleString()}</p>
        <p><strong>Productos:</strong> ${e.products.map(p=>p.title).join(", ")}</p>
        <p><strong>Importe Bruto:</strong> ${r.toFixed(2)} €</p>
        <p><strong>IGI (7%):</strong> ${n.toFixed(2)} €</p>
        <p><strong>Total a Pagar:</strong> ${a.toFixed(2)} €</p>
        <p><strong>Método de pago:</strong> ${t}</p>
        <img src="${l}" class="sello" alt="Sello" />
        <footer>
          <p>Gracias por su compra</p>
          <p>¡Vuelva pronto!</p>
        </footer>
        <script>
          window.onload = function () {
            window.print();
            setTimeout(() => window.close(), 1000);
          };
        <\/script>
      </body>
    </html>
  `;i.document.open(),i.document.write(d),i.document.close()};let P=!1;const ge=(e,t)=>{if(e.status==="Cobrada")return;const o=document.createElement("button");o.textContent=e.status==="Pendiente"?"Aceptar":e.status==="Listo"?"Cobrar":"Listo",o.setAttribute("data-order-id",e._id),o.setAttribute("data-status",e.status),t.append(o);const a=document.createElement("select");if(a.id=`select-payment-method-${e._id}`,[{value:"",text:"Seleccione método",disabled:!0,selected:!0},{value:"Tarjeta",text:"Tarjeta"},{value:"Efectivo",text:"Efectivo"},{value:"Maquinas Recreativas",text:"Máquinas Recreativas"},{value:"Glovo",text:"Glovo"}].forEach(r=>{const s=document.createElement("option");s.value=r.value,s.textContent=r.text,r.disabled&&(s.disabled=!0),r.selected&&(s.selected=!0),a.append(s)}),o.addEventListener("click",()=>{const r=o.getAttribute("data-order-id"),s=o.getAttribute("data-status");if(o.textContent==="Cobrar"){const c=document.querySelector(`#select-payment-method-${e._id}`);if(c&&c.value==="")return alert("Por favor, seleccione un método de pago.");const l=c.value;O(r,s,o,l),e.nameTable?confirm("¿Necesitas el recibo?")&&F(e,l):F(e,l)}else O(r,s,o);requestAnimationFrame(()=>_()),le(r)}),e.nameTable){const r=document.createElement("button");r.textContent="mas",r.setAttribute("data-order-id",e._id),r.id=`update-btn-${e._id}`,t.append(r),t.append(a),r.addEventListener("click",()=>{const s=r.getAttribute("data-order-id");P?(de(s,r),B(!1),P=!1):(fe(`#update-btn-${e._id}`,"#platos-lista .has-tooltip"),P=!0)})}},be=e=>{const t=e.nameTable||"DOMICILIO",o=e.user[0].name||e.user.name,a=new Date(e.createdAt).toLocaleString(),n=Math.floor((Date.now()-new Date(e.createdAt))/6e4),r=e.products.map(d=>d.title).join(", "),s=document.createElement("li"),c=document.createElement("details"),l=document.createElement("summary");l.textContent=`Pedido: ${t}`,c.append(l);const i=Q(e,t,o,a,n,r);return X(i,c),ge(e,c),s.append(c),s},b=(e,t,o)=>{const a=document.querySelector(`#${e}`),n=document.createElement("tr");o.forEach(c=>{const l=document.createElement("td");let i=t[c]||"";e==="tablaClientes"&&["name","email","telephon"].includes(c)||e==="tableReservation"&&["name","telephon"].includes(c)?i=t.userId?t.userId[c]:"":c==="reservationDate"&&i?i=new Date(i).toLocaleDateString("es-ES").replace(/\//g,"-"):e==="tablaInventario"&&c==="precio"?i=`${i}€`:c==="wastageProduct"&&t[c]&&(i=t[c].producto||""),l.innerHTML=i,n.append(l)});const r=document.createElement("td");r.setAttribute("data-id",t._id),r.style.display="none",r.innerHTML=t._id,n.append(r);const s=document.createElement("td");s.innerHTML='<button class="editar">Editar</button><button class="eliminar">Eliminar</button>',n.append(s),a.querySelector("tbody").append(n)},ye=e=>{const t=document.querySelector("#pedidos ul"),o=be(e);t.append(o)},he=e=>{const t=document.querySelector("#platos-lista");let o=Array.from(t.querySelectorAll("h2")).find(r=>r.textContent===e.category),a;if(o)a=o.nextElementSibling,(!a||a.tagName!=="UL")&&(a=document.createElement("ul"),o.insertAdjacentElement("afterend",a));else{const r=document.createElement("h2");r.textContent=e.category,t.append(r),a=document.createElement("ul"),t.append(a)}const n=R(e);a.append(n)},$=(e,t,o)=>{const{originalWastaId:a,updatedWastage:{wastageProduct:{_id:n,producto:r}={},wastage:s}={},originalWastageName:c,originalWastageAmount:l,wastageProduct:{_id:i}={},wastage:d}=e,p=n||i,m=s||d;Array.from(document.querySelector(`#${t} tbody`).rows).forEach(h=>{const w=h.querySelector("[data-id]"),f=h.cells[1];if(!w)return;const I=w.dataset.id,g=parseInt(f.textContent);if(o==="PUT"&&r!==c)I===a?f.textContent=g+l:I===p&&(f.textContent=g-m);else if(I===p){let E;switch(o){case"DELETE":E=g+m;break;case"POST":E=g-m;break;case"PUT":E=g+(l-m);break;default:console.error(`Método no soportado: ${o}`);return}f.textContent=E}})},we=e=>e.reduce((t,o)=>o.ingredients&&Array.isArray(o.ingredients)?t.concat(o.ingredients):t,[]),H=(e,t)=>{let o;t.length>0&&t[0].ingredients?o=we(t):o=t;const a=document.querySelector(`#${e}`);for(let n=1;n<a.rows.length;n++){const r=a.rows[n].cells[0].textContent,s=o.find(c=>c.name===r);if(s){const c=a.rows[n].cells[1];let l=parseInt(c.textContent);l-=parseInt(s.amount),c.textContent=l}}},S=async(e,t)=>{try{const o=new FormData(e);return await y(t,o,e)}catch(o){u("Error al registrar producto",o)}},Ee=async e=>{try{const t=new FormData(e),o=await y("plate/",t,e);he(o),document.querySelectorAll("#ingredientInputs > div").forEach(n=>n.remove())}catch(t){u("Error al registrar menú",t)}},ve=async e=>{try{const t=new FormData(e);await y("users/register",t,e,!1),window.location.href="../../../index.html"}catch(t){u("Error al registrar usuario",t)}},Se=async e=>{try{const t=new FormData(e),o=t.get("email"),a=t.get("password");if(!o||!a)return alert("Por favor, complete todos los campos.");if(!/^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).{8,}$/.test(a))return alert("La contraseña debe contener al menos un número, una letra mayúscula y una letra minúscula, y tener al menos 8 caracteres.");const r=await y("users/login",t,e,!1),s=r.user._id,c=r.token;localStorage.setItem("token",c),localStorage.setItem("userId",s),window.location.href="/TPV.html#inventario"}catch(t){u("Error al iniciar sesión",t)}},xe=async(e,t)=>{const o=new FormData;o.append("nameTable",e.nameTable),o.append("user[]",e.user),e.products.forEach((a,n)=>o.append(`products[${n}]`,a.id));try{const a=await y("pedidos/",o,null);console.log(a.products),H("tablaInventario",a.products),ye(a),requestAnimationFrame(()=>_()),localStorage.removeItem("order"),t.remove()}catch(a){u("Error al registrar pedido",a)}};document.addEventListener("submit",async e=>{e.preventDefault();const t=e.target,o=t.dataset.submit,a={productSubmit:async()=>{const n=await S(t,"productos");b("tablaInventario",n,["producto","cantidad","precio","maxAmount","categoria","proveedor"]),H("tablaInventario",n.ingredients)},wastageSubmit:async()=>{const n=await S(t,"wasteControl");b("tablaMerma",n,["wastageProduct","wastage","reason"]),$(n,"tablaInventario","POST")},employeeSubmit:async()=>{const n=await S(t,"users/register");b("tablaEmpleados",n,["name","job","telephon","salary"])},reservations:async()=>{const n=await S(t,"reservation");b("tableReservation",n,["name","table","telephon","reservationDate","reservationTime"]),b("tablaClientes",n,["name","email","telephon"])},plateMenu:()=>Ee(t),register:()=>ve(t),login:()=>Se(t)};a[o]&&await a[o]()});export{Ie as a,Pe as b,qe as c,Ce as d,ae as e,fe as f,Y as g,B as h,be as p,u as s,_ as t};
